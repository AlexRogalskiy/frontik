<script>
    function getClosest(elem, selector) {
        for (; elem && elem !== document; elem = elem.parentNode) {
            if (elem.matches(selector)) {
                return elem;
            }
        }
        return null;
    };

    function sortTableColumn(header) {
        var table = getClosest(header, 'table');
        var columnIndex = header.cellIndex;
        var rows = [];
        var tBody = table.tBodies[0];

        for (var i = 0; i < tBody.rows.length; i++) {
            rows.push(tBody.rows[i]);
        }

        function cellText(row, index) {
            return row.cells[index].textContent || row.cells[index].innerText;
        }

        rows = rows.sort(function(a, b) {
            var v1 = parseFloat(cellText(a, columnIndex)),
                v2 = parseFloat(cellText(b, columnIndex));

            if (v1 == v2) {
                var s1 = cellText(a, 0) + cellText(a, 1) + cellText(a, 2),
                    s2 = cellText(b, 0) + cellText(b, 1) + cellText(b, 2);
                return s1 <= s2 ? 1 : -1;
            }

            return v1 < v2 ? 1 : -1;
        });

        while (tBody.rows.length > 0) {
            tBody.deleteRow(0);
        }
        for (var i = 0; i < rows.length; i++) {
            tBody.appendChild(rows[i]);
        }
    }

    document.addEventListener('DOMContentLoaded', function(event) {
        var sql = document.getElementsByClassName('sql highlighted-code');
        Array.prototype.forEach.call(sql, function(el) {
            el.innerHTML = vkbeautify.sql(el.textContent);
        });
    });
</script>
